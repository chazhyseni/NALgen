<!DOCTYPE html>
<html class="no-js" lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>NALgen Analysis Pt.1 - NALgen</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="Multivariate Analyses: Inferring population structure in simulated data">
	<meta property="og:title" content="NALgen Analysis Pt.1" />
<meta property="og:description" content="Multivariate Analyses: Inferring population structure in simulated data" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/NALgen/post/multivariateanalysis_popstruct_simulateddata/" />
<meta property="article:published_time" content="2019-07-19T00:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2019-07-19T00:00:00&#43;00:00"/>

	
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">
	<link rel="stylesheet" href="/NALgen/css/style.css">
	
	<link rel="shortcut icon" href="/NALgen/favicon.ico">
		
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-139514839-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container">
		<div class="logo">
			<a class="logo__link" href="/NALgen" title="NALgen" rel="home">
				<div class="logo__title">NALgen</div>
				<div class="logo__tagline">Neutral and Adaptive Landscape Genetics</div>
			</a>
		</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">Menu</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/NALgen/about/">About</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/NALgen/vignettes/">Vignettes</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/NALgen/tutorials/">Tutorials</a>
		</li>
	</ul>
</nav>

	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">NALgen Analysis Pt.1</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg>
	<time class="meta__text" datetime="2019-07-19T00:00:00">July 19, 2019</time>
</div>

<div class="meta__item-categories meta__item">
	<svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg>
	<span class="meta__text"><a class="meta__link" href="/NALgen/categories/analysis" rel="category">Analysis</a></span>
</div>
</div>
		</header><div class="content post__content clearfix">
			<p>Here, I present the prequel to the NALgen method: using multivariate analyses to infer population structure in the simulated data as well as to find covariance between genetic and environmental data. In upcoming posts about modeling neutral and adaptive genetic variation across continuous landscapes, information about population structure will be used in creating the response variable, while transformed environmental data (based on genetic-environmental covariance) will be used as predictors.</p>

<h2 id="color-palette">Color palette</h2>

<pre><code class="language-r">library(ggsci)
futr &lt;- pal_futurama()
futr.cols &lt;- colorRampPalette(futr(12)[c(12,11,3,7,8,6,1,2)])
cols &lt;- futr.cols(12)

library(scales)
#show_col(futr(12))
show_col(cols)
</code></pre>

<p><img src="MultivariateAnalysis_PopStruct_SimulatedData_files/figure-html/unnamed-chunk-1-1.png" alt="" /><!-- --></p>

<h1 id="preliminary-nalgen-analysis-pt-1-multivariate-ordinations">Preliminary NALgen analysis pt.1: Multivariate ordinations</h1>

<h2 id="loading-the-environmental-data">Loading the environmental data</h2>

<pre><code class="language-r">library(raster)
</code></pre>

<pre><code>## Loading required package: sp
</code></pre>

<pre><code class="language-r">library(virtualspecies)
#load bioclim files
setwd(&quot;C:/Users/chazh/Documents/Research Projects/Reticulitermes/Phylogeography/Geo_Analysis/Data/EnvData/bioclim/east coast/current&quot;)
fn &lt;- list.files(pattern=&quot;.asc&quot;)
bio_stk &lt;- stack()
for(i in 1:length(fn)) bio_stk &lt;- addLayer(bio_stk,raster(fn[i]))

#modify variable names
nampres &lt;- sub(pattern=&quot;Ecoast&quot;,replacement=&quot;&quot;,names(bio_stk))
nampres &lt;- sub(pattern=&quot;_&quot;,replacement=&quot;&quot;,nampres)
nampres &lt;- sub(pattern=&quot;_&quot;,replacement=&quot;&quot;,nampres)
names(bio_stk) &lt;- nampres

##remove highly correlated variables
#rc_bio &lt;- removeCollinearity(bio_stk, select.variables = TRUE, plot = TRUE, multicollinearity.cutoff = 0.3)

#plot parameters
par(mfrow=c(1,1),fg=&quot;gray50&quot;,pty='m',bty='o',mar=c(4,4,4,4),cex.main=1.3,cex.axis=1.1,cex.lab=1.2)

##names for plot titles
#bionames &lt;- c(&quot;Isothermality&quot;,&quot;Annual Mean Temperature&quot;,&quot;Annual Precipitation&quot;,&quot;Temperature Seasonality&quot;,&quot;Precipitation Seasonality&quot;,&quot;Mean Diurnal Range&quot;,&quot;Temperature Annual Range&quot;,&quot;Max. Temperature Warmest Month&quot;,&quot;Min. Temperature Coldest Month&quot;,&quot;Mean Temperature Warmest Quarter&quot;,&quot;Precipitation Warmest Quarter&quot;,&quot;Mean Temperature Coldest Quarter&quot;,&quot;Precipitation Coldest Quarter&quot;,&quot;Mean Temperature Wettest Quarter&quot;,&quot;Precipitation Wettest Quarter&quot;,&quot;Mean Temperature Driest Quarter&quot;,&quot;Precipitation Driest Quarter&quot;,&quot;Precipitation Wettest Month&quot;,&quot;Precipitation Driest Month&quot;)
#biovars &lt;- paste0(&quot;bio&quot;,c(3,1,12,4,15,2,7,5,6,10,18,19,11,8,16,9,17,13,14))

##plot bioclim variables left after removing collinearity
#for (i in rc_bio){
#   plot(bio_stk[[i]], main=bionames[which(biovars==rc_bio[i])],
#       breaks=seq(round(min(as.matrix(bio_stk[[i]]),na.rm=T),1),
#                  round(max(as.matrix(bio_stk[[i]]),na.rm=T),1),length.out=11),
#       col=cols)
#}

setwd(&quot;C:/Users/chazh/Documents/Research Projects/Reticulitermes/Phylogeography/Geo_Analysis/Data/EnvData/bioclim_FA/east coast/Finalized/current&quot;)
fn &lt;- list.files(pattern=&quot;.asc&quot;)
fa_stk &lt;- stack()
for(i in 1:length(fn)) fa_stk=addLayer(fa_stk,raster(fn[i]))

#names for plot titles
fa_stk_names &lt;- c(&quot;Annual Temperature Range&quot;, &quot;Dry-Season Precipitation&quot;, &quot;Summer Temperature&quot;, &quot;Wet-Season Precipitation&quot;)

#plot Environmental Factors (https://datadryad.org/resource/doi:10.5061/dryad.5hr7f31)
for (i in 1:4){
   plot(fa_stk[[i]], main=fa_stk_names[i],
       breaks=seq(round(min(as.matrix(fa_stk[[i]]),na.rm=T),1),
                  round(max(as.matrix(fa_stk[[i]]),na.rm=T),1),length.out=11),
       col=cols)
}
</code></pre>

<p><img src="MultivariateAnalysis_PopStruct_SimulatedData_files/figure-html/unnamed-chunk-2-1.png" alt="" /><!-- --><img src="MultivariateAnalysis_PopStruct_SimulatedData_files/figure-html/unnamed-chunk-2-2.png" alt="" /><!-- --><img src="MultivariateAnalysis_PopStruct_SimulatedData_files/figure-html/unnamed-chunk-2-3.png" alt="" /><!-- --><img src="MultivariateAnalysis_PopStruct_SimulatedData_files/figure-html/unnamed-chunk-2-4.png" alt="" /><!-- --></p>

<h2 id="loading-the-genetic-data">Loading the genetic data</h2>

<pre><code class="language-r">library(adegenet)


m0.1_n &lt;- &quot;C:/Users/chazh/Documents/Research Projects/Reticulitermes/Simulations/popRange/m_0_1/Simulated_Genotypes/20pop_subsets/neutral_only&quot;
m0.1_n.s &lt;- &quot;C:/Users/chazh/Documents/Research Projects/Reticulitermes/Simulations/popRange/m_0_1/Simulated_Genotypes/20pop_subsets/neutral+selected&quot;
m0.1_s &lt;- &quot;C:/Users/chazh/Documents/Research Projects/Reticulitermes/Simulations/popRange/m_0_1/Simulated_Genotypes/20pop_subsets/selected_only&quot;
m0.5_n &lt;- &quot;C:/Users/chazh/Documents/Research Projects/Reticulitermes/Simulations/popRange/m_0_5/Simulated_Genotypes/20pop_subsets/neutral_only&quot;
m0.5_n.s &lt;- &quot;C:/Users/chazh/Documents/Research Projects/Reticulitermes/Simulations/popRange/m_0_5/Simulated_Genotypes/20pop_subsets/neutral+selected&quot;
m0.5_s &lt;- &quot;C:/Users/chazh/Documents/Research Projects/Reticulitermes/Simulations/popRange/m_0_5/Simulated_Genotypes/20pop_subsets/selected_only&quot;


setwd(&quot;C:/Users/chazh/Documents/Research Projects/Reticulitermes/NALgen_Analysis/Multivariate/&quot;)

#define function
xyFromRC &lt;- function(genind, rastr){
   coord &lt;- genind$other
   row.no &lt;- coord[,1]+1
   col.no &lt;- coord[,2]+1
   cell.no &lt;- cellFromRowCol(rastr,row=row.no,col=col.no)
   coord &lt;- xyFromCell(rastr, cell.no)
   as.data.frame(coord)
}



###m0.1###
##neutral ONLY##
m0.1_lclp_n &lt;- read.genepop(paste0(m0.1_n,&quot;lclp_only-neutr_20pops.gen&quot;))
m0.1_lclp_n$other &lt;- read.table(paste0(m0.1_n,&quot;lclp_20pops_coords.txt&quot;), sep=&quot; &quot;,header=F)
colnames(m0.1_lclp_n$other)=c(&quot;x&quot;,&quot;y&quot;)
m0.1_lclp_n$other &lt;- xyFromRC(m0.1_lclp_n, fa_stk)
m0.1_lchp_n &lt;- read.genepop(paste0(m0.1_n,&quot;lchp_only-neutr_20pops.gen&quot;))
m0.1_lchp_n$other &lt;- read.table(paste0(m0.1_n,&quot;lchp_20pops_coords.txt&quot;), sep=&quot; &quot;,header=F)
colnames(m0.1_lchp_n$other)=c(&quot;x&quot;,&quot;y&quot;)
m0.1_lchp_n$other &lt;- xyFromRC(m0.1_lchp_n, fa_stk)
m0.1_hchp_n &lt;- read.genepop(paste0(m0.1_n,&quot;hchp_only-neutr_20pops.gen&quot;))
m0.1_hchp_n$other &lt;- read.table(paste0(m0.1_n,&quot;hchp_20pops_coords.txt&quot;), sep=&quot; &quot;,header=F)
colnames(m0.1_hchp_n$other)=c(&quot;x&quot;,&quot;y&quot;)
m0.1_hchp_n$other &lt;- xyFromRC(m0.1_hchp_n, fa_stk)
m0.1_hclp_n &lt;- read.genepop(paste0(m0.1_n,&quot;hclp_only-neutr_20pops.gen&quot;))
m0.1_hclp_n$other &lt;- read.table(paste0(m0.1_n,&quot;hclp_20pops_coords.txt&quot;), sep=&quot; &quot;,header=F)
colnames(m0.1_hclp_n$other)=c(&quot;x&quot;,&quot;y&quot;)
m0.1_hclp_n$other &lt;- xyFromRC(m0.1_hclp_n, fa_stk)

##selected ONLY##
m0.1_lclp_s &lt;- read.genepop(paste0(m0.1_s,&quot;lclp_only-sel_20pops.gen&quot;))
m0.1_lclp_s$other &lt;- read.table(paste0(m0.1_s,&quot;lclp_20pops_coords.txt&quot;), sep=&quot; &quot;,header=F)
colnames(m0.1_lclp_s$other)=c(&quot;x&quot;,&quot;y&quot;)
m0.1_lclp_s$other &lt;- xyFromRC(m0.1_lclp_s, fa_stk)
m0.1_lchp_s &lt;- read.genepop(paste0(m0.1_s,&quot;lchp_only-sel_20pops.gen&quot;))
m0.1_lchp_s$other &lt;- read.table(paste0(m0.1_s,&quot;lchp_20pops_coords.txt&quot;), sep=&quot; &quot;,header=F)
colnames(m0.1_lchp_s$other)=c(&quot;x&quot;,&quot;y&quot;)
m0.1_lchp_s$other &lt;- xyFromRC(m0.1_lchp_s, fa_stk)
m0.1_hchp_s &lt;- read.genepop(paste0(m0.1_s,&quot;hchp_only-sel_20pops.gen&quot;))
m0.1_hchp_s$other &lt;- read.table(paste0(m0.1_s,&quot;hchp_20pops_coords.txt&quot;), sep=&quot; &quot;,header=F)
colnames(m0.1_hchp_s$other)=c(&quot;x&quot;,&quot;y&quot;)
m0.1_hchp_s$other &lt;- xyFromRC(m0.1_hchp_s, fa_stk)
m0.1_hclp_s &lt;- read.genepop(paste0(m0.1_s,&quot;hclp_only-sel_20pops.gen&quot;))
m0.1_hclp_s$other &lt;- read.table(paste0(m0.1_s,&quot;hclp_20pops_coords.txt&quot;), sep=&quot; &quot;,header=F)
colnames(m0.1_hclp_s$other)=c(&quot;x&quot;,&quot;y&quot;)
m0.1_hclp_s$other &lt;- xyFromRC(m0.1_hclp_s, fa_stk)

##neutral AND selected##
m0.1_lclp_n.s &lt;- read.genepop(paste0(m0.1_n.s,&quot;lclp_20pops.gen&quot;))
m0.1_lclp_n.s$other &lt;- read.table(paste0(m0.1_n.s,&quot;lclp_20pops_coords.txt&quot;), sep=&quot; &quot;,header=F)
colnames(m0.1_lclp_n.s$other)=c(&quot;x&quot;,&quot;y&quot;)
m0.1_lclp_n.s$other &lt;- xyFromRC(m0.1_lclp_n.s, fa_stk)
m0.1_lchp_n.s &lt;- read.genepop(paste0(m0.1_n.s,&quot;lchp_20pops.gen&quot;))
m0.1_lchp_n.s$other &lt;- read.table(paste0(m0.1_n.s,&quot;lchp_20pops_coords.txt&quot;), sep=&quot; &quot;,header=F)
colnames(m0.1_lchp_n.s$other)=c(&quot;x&quot;,&quot;y&quot;)
m0.1_lchp_n.s$other &lt;- xyFromRC(m0.1_lchp_n.s, fa_stk)
m0.1_hchp_n.s &lt;- read.genepop(paste0(m0.1_n.s,&quot;hchp_20pops.gen&quot;))
m0.1_hchp_n.s$other &lt;- read.table(paste0(m0.1_n.s,&quot;hchp_20pops_coords.txt&quot;), sep=&quot; &quot;,header=F)
colnames(m0.1_hchp_n.s$other)=c(&quot;x&quot;,&quot;y&quot;)
m0.1_hchp_n.s$other &lt;- xyFromRC(m0.1_hchp_n.s, fa_stk)
m0.1_hclp_n.s &lt;- read.genepop(paste0(m0.1_n.s,&quot;hclp_20pops.gen&quot;))
m0.1_hclp_n.s$other &lt;- read.table(paste0(m0.1_n.s,&quot;hclp_20pops_coords.txt&quot;), sep=&quot; &quot;,header=F)
colnames(m0.1_hclp_n.s$other)=c(&quot;x&quot;,&quot;y&quot;)
m0.1_hclp_n.s$other &lt;- xyFromRC(m0.1_hclp_n.s, fa_stk)


###m0.5###
##neutral ONLY##
m0.5_lclp_n &lt;- read.genepop(paste0(m0.5_n,&quot;lclp_only-neutr_20pops.gen&quot;))
m0.5_lclp_n$other &lt;- read.table(paste0(m0.5_n,&quot;lclp_20pops_coords.txt&quot;), sep=&quot; &quot;,header=F)
colnames(m0.5_lclp_n$other)=c(&quot;x&quot;,&quot;y&quot;)
m0.5_lclp_n$other &lt;- xyFromRC(m0.5_lclp_n, fa_stk)
m0.5_lchp_n &lt;- read.genepop(paste0(m0.5_n,&quot;lchp_only-neutr_20pops.gen&quot;))
m0.5_lchp_n$other &lt;- read.table(paste0(m0.5_n,&quot;lchp_20pops_coords.txt&quot;), sep=&quot; &quot;,header=F)
colnames(m0.5_lchp_n$other)=c(&quot;x&quot;,&quot;y&quot;)
m0.5_lchp_n$other &lt;- xyFromRC(m0.5_lchp_n, fa_stk)
m0.5_hchp_n &lt;- read.genepop(paste0(m0.5_n,&quot;hchp_only-neutr_20pops.gen&quot;))
m0.5_hchp_n$other &lt;- read.table(paste0(m0.5_n,&quot;hchp_20pops_coords.txt&quot;), sep=&quot; &quot;,header=F)
colnames(m0.5_hchp_n$other)=c(&quot;x&quot;,&quot;y&quot;)
m0.5_hchp_n$other &lt;- xyFromRC(m0.5_hchp_n, fa_stk)
m0.5_hclp_n &lt;- read.genepop(paste0(m0.5_n,&quot;hclp_only-neutr_20pops.gen&quot;))
m0.5_hclp_n$other &lt;- read.table(paste0(m0.5_n,&quot;hclp_20pops_coords.txt&quot;), sep=&quot; &quot;,header=F)
colnames(m0.5_hclp_n$other)=c(&quot;x&quot;,&quot;y&quot;)
m0.5_hclp_n$other &lt;- xyFromRC(m0.5_hclp_n, fa_stk)

##selected ONLY##
m0.5_lclp_s &lt;- read.genepop(paste0(m0.5_s,&quot;lclp_only-sel_20pops.gen&quot;))
m0.5_lclp_s$other &lt;- read.table(paste0(m0.5_s,&quot;lclp_20pops_coords.txt&quot;), sep=&quot; &quot;,header=F)
colnames(m0.5_lclp_s$other)=c(&quot;x&quot;,&quot;y&quot;)
m0.5_lclp_s$other &lt;- xyFromRC(m0.5_lclp_s, fa_stk)
m0.5_lchp_s &lt;- read.genepop(paste0(m0.5_s,&quot;lchp_only-sel_20pops.gen&quot;))
m0.5_lchp_s$other &lt;- read.table(paste0(m0.5_s,&quot;lchp_20pops_coords.txt&quot;), sep=&quot; &quot;,header=F)
colnames(m0.5_lchp_s$other)=c(&quot;x&quot;,&quot;y&quot;)
m0.5_lchp_s$other &lt;- xyFromRC(m0.5_lchp_s, fa_stk)
m0.5_hchp_s &lt;- read.genepop(paste0(m0.5_s,&quot;hchp_only-sel_20pops.gen&quot;))
m0.5_hchp_s$other &lt;- read.table(paste0(m0.5_s,&quot;hchp_20pops_coords.txt&quot;), sep=&quot; &quot;,header=F)
colnames(m0.5_hchp_s$other)=c(&quot;x&quot;,&quot;y&quot;)
m0.5_hchp_s$other &lt;- xyFromRC(m0.5_hchp_s, fa_stk)
m0.5_hclp_s &lt;- read.genepop(paste0(m0.5_s,&quot;hclp_only-sel_20pops.gen&quot;))
m0.5_hclp_s$other &lt;- read.table(paste0(m0.5_s,&quot;hclp_20pops_coords.txt&quot;), sep=&quot; &quot;,header=F)
colnames(m0.5_hclp_s$other)=c(&quot;x&quot;,&quot;y&quot;)
m0.5_hclp_s$other &lt;- xyFromRC(m0.5_hclp_s, fa_stk)

##neutral AND selected##
m0.5_lclp_n.s &lt;- read.genepop(paste0(m0.5_n.s,&quot;lclp_20pops.gen&quot;))
m0.5_lclp_n.s$other &lt;- read.table(paste0(m0.5_n.s,&quot;lclp_20pops_coords.txt&quot;), sep=&quot; &quot;,header=F)
colnames(m0.5_lclp_n.s$other)=c(&quot;x&quot;,&quot;y&quot;)
m0.5_lclp_n.s$other &lt;- xyFromRC(m0.5_lclp_n.s, fa_stk)
m0.5_lchp_n.s &lt;- read.genepop(paste0(m0.5_n.s,&quot;lchp_20pops.gen&quot;))
m0.5_lchp_n.s$other &lt;- read.table(paste0(m0.5_n.s,&quot;lchp_20pops_coords.txt&quot;), sep=&quot; &quot;,header=F)
colnames(m0.5_lchp_n.s$other)=c(&quot;x&quot;,&quot;y&quot;)
m0.5_lchp_n.s$other &lt;- xyFromRC(m0.5_lchp_n.s, fa_stk)
m0.5_hchp_n.s &lt;- read.genepop(paste0(m0.5_n.s,&quot;hchp_20pops.gen&quot;))
m0.5_hchp_n.s$other &lt;- read.table(paste0(m0.5_n.s,&quot;hchp_20pops_coords.txt&quot;), sep=&quot; &quot;,header=F)
colnames(m0.5_hchp_n.s$other)=c(&quot;x&quot;,&quot;y&quot;)
m0.5_hchp_n.s$other &lt;- xyFromRC(m0.5_hchp_n.s, fa_stk)
m0.5_hclp_n.s &lt;- read.genepop(paste0(m0.5_n.s,&quot;hclp_20pops.gen&quot;))
m0.5_hclp_n.s$other &lt;- read.table(paste0(m0.5_n.s,&quot;hclp_20pops_coords.txt&quot;), sep=&quot; &quot;,header=F)
colnames(m0.5_hclp_n.s$other)=c(&quot;x&quot;,&quot;y&quot;)
m0.5_hclp_n.s$other &lt;- xyFromRC(m0.5_hclp_n.s, fa_stk)
</code></pre>

<pre><code class="language-r">temp.dapc.obj &lt;- dapc(m0.1_lclp_n,center=T,scale=F,n.pca=500,n.da=2)
temp &lt;- optim.a.score(temp.dapc.obj)
best.n.pca &lt;- temp$best
dapc.obj &lt;- dapc(m0.1_lclp_n,center=T,scale=F,n.pca=best.n.pca,n.da=2)

scatter(dapc.obj,col=cols,ratio.pca=0.3,bg=&quot;white&quot;,main=&quot;m = 0.1, low complexity, low permeability, neutral loci only&quot;,
    pch=15:17,cell=0,cstar=0,solid=0.9,cex=1.8,clab=0,
    mstree=TRUE,lwd=3,scree.da=FALSE,leg=TRUE,txt.leg=popNames(m0.1_lclp_n))
par(xpd=TRUE)
points(dapc.obj$grp.coord[,1],dapc.obj$grp.coord[,2],pch=c(22,21,24),cex=2,lwd=3,col=&quot;black&quot;,bg=cols)
</code></pre>

<pre><code class="language-r">temp.dapc.obj &lt;- dapc(m0.1_lclp_s,center=T,scale=F,n.pca=500,n.da=2)
temp &lt;- optim.a.score(temp.dapc.obj)
best.n.pca &lt;- temp$best
dapc.obj &lt;- dapc(m0.1_lclp_s,center=T,scale=F,n.pca=best.n.pca,n.da=2)

scatter(dapc.obj,col=cols,ratio.pca=0.3,bg=&quot;white&quot;,main=&quot;m = 0.1, low complexity, low permeability, selected loci only&quot;,
    pch=15:17,cell=0,cstar=0,solid=0.9,cex=1.8,clab=0,
    mstree=TRUE,lwd=3,scree.da=FALSE,leg=TRUE,txt.leg=popNames(m0.1_lclp_n))
par(xpd=TRUE)
points(dapc.obj$grp.coord[,1],dapc.obj$grp.coord[,2],pch=c(22,21,24),cex=2,lwd=3,col=&quot;black&quot;,bg=cols)
</code></pre>

<pre><code class="language-r">temp.dapc.obj &lt;- dapc(m0.1_lclp_n.s,center=T,scale=F,n.pca=500,n.da=2)
temp &lt;- optim.a.score(temp.dapc.obj)
best.n.pca &lt;- temp$best
dapc.obj &lt;- dapc(m0.1_lclp_n.s,center=T,scale=F,n.pca=best.n.pca,n.da=2)

scatter(dapc.obj,col=cols,ratio.pca=0.3,bg=&quot;white&quot;,main=&quot;m = 0.1, low complexity, low permeability, neutral and selected loci&quot;,
    pch=15:17,cell=0,cstar=0,solid=0.9,cex=1.8,clab=0,
    mstree=TRUE,lwd=3,scree.da=FALSE,leg=TRUE,txt.leg=popNames(m0.1_lclp_n))
par(xpd=TRUE)
points(dapc.obj$grp.coord[,1],dapc.obj$grp.coord[,2],pch=c(22,21,24),cex=2,lwd=3,col=&quot;black&quot;,bg=cols)
</code></pre>

<pre><code class="language-r">temp.dapc.obj &lt;- dapc(m0.5_lclp_n,center=T,scale=F,n.pca=500,n.da=2)
temp &lt;- optim.a.score(temp.dapc.obj)
best.n.pca &lt;- temp$best
dapc.obj &lt;- dapc(m0.5_lclp_n,center=T,scale=F,n.pca=best.n.pca,n.da=2)

scatter(dapc.obj,col=cols,ratio.pca=0.3,bg=&quot;white&quot;,main=&quot;m = 0.5, low complexity, low permeability, neutral loci only&quot;,
    pch=15:17,cell=0,cstar=0,solid=0.9,cex=1.8,clab=0,
    mstree=TRUE,lwd=3,scree.da=FALSE,leg=TRUE,txt.leg=popNames(m0.5_lclp_n))
par(xpd=TRUE)
points(dapc.obj$grp.coord[,1],dapc.obj$grp.coord[,2],pch=c(22,21,24),cex=2,lwd=3,col=&quot;black&quot;,bg=cols)
</code></pre>

<pre><code class="language-r">temp.dapc.obj &lt;- dapc(m0.5_lclp_s,center=T,scale=F,n.pca=500,n.da=2)
temp &lt;- optim.a.score(temp.dapc.obj)
best.n.pca &lt;- temp$best
dapc.obj &lt;- dapc(m0.5_lclp_s,center=T,scale=F,n.pca=best.n.pca,n.da=2)

scatter(dapc.obj,col=cols,ratio.pca=0.3,bg=&quot;white&quot;,main=&quot;m = 0.5, low complexity, low permeability, selected loci only&quot;,
    pch=15:17,cell=0,cstar=0,solid=0.9,cex=1.8,clab=0,
    mstree=TRUE,lwd=3,scree.da=FALSE,leg=TRUE,txt.leg=popNames(m0.5_lclp_n))
par(xpd=TRUE)
points(dapc.obj$grp.coord[,1],dapc.obj$grp.coord[,2],pch=c(22,21,24),cex=2,lwd=3,col=&quot;black&quot;,bg=cols)
</code></pre>

<pre><code class="language-r">temp.dapc.obj &lt;- dapc(m0.5_lclp_n.s,center=T,scale=F,n.pca=500,n.da=2)
temp &lt;- optim.a.score(temp.dapc.obj)
best.n.pca &lt;- temp$best
dapc.obj &lt;- dapc(m0.5_lclp_n.s,center=T,scale=F,n.pca=best.n.pca,n.da=2)

scatter(dapc.obj,col=cols,ratio.pca=0.3,bg=&quot;white&quot;,main=&quot;m = 0.5, low complexity, low permeability, neutral and selected loci&quot;,
    pch=15:17,cell=0,cstar=0,solid=0.9,cex=1.8,clab=0,
    mstree=TRUE,lwd=3,scree.da=FALSE,leg=TRUE,txt.leg=popNames(m0.5_lclp_n))
par(xpd=TRUE)
points(dapc.obj$grp.coord[,1],dapc.obj$grp.coord[,2],pch=c(22,21,24),cex=2,lwd=3,col=&quot;black&quot;,bg=cols)
</code></pre>

<pre><code class="language-r">temp.dapc.obj &lt;- dapc(m0.1_lchp_n,center=T,scale=F,n.pca=500,n.da=2)
temp &lt;- optim.a.score(temp.dapc.obj)
best.n.pca &lt;- temp$best
dapc.obj &lt;- dapc(m0.1_lchp_n,center=T,scale=F,n.pca=best.n.pca,n.da=2)

scatter(dapc.obj,col=cols,ratio.pca=0.3,bg=&quot;white&quot;,main=&quot;m = 0.1, low complexity, high permeability, neutral loci only&quot;,
    pch=15:17,cell=0,cstar=0,solid=0.9,cex=1.8,clab=0,
    mstree=TRUE,lwd=3,scree.da=FALSE,leg=TRUE,txt.leg=popNames(m0.1_lchp_n))
par(xpd=TRUE)
points(dapc.obj$grp.coord[,1],dapc.obj$grp.coord[,2],pch=c(22,21,24),cex=2,lwd=3,col=&quot;black&quot;,bg=cols)
</code></pre>

<pre><code class="language-r">temp.dapc.obj &lt;- dapc(m0.1_lchp_s,center=T,scale=F,n.pca=500,n.da=2)
temp &lt;- optim.a.score(temp.dapc.obj)
best.n.pca &lt;- temp$best
dapc.obj &lt;- dapc(m0.1_lchp_s,center=T,scale=F,n.pca=best.n.pca,n.da=2)

scatter(dapc.obj,col=cols,ratio.pca=0.3,bg=&quot;white&quot;,main=&quot;m = 0.1, low complexity, high permeability, selected loci only&quot;,
    pch=15:17,cell=0,cstar=0,solid=0.9,cex=1.8,clab=0,
    mstree=TRUE,lwd=3,scree.da=FALSE,leg=TRUE,txt.leg=popNames(m0.1_lchp_n))
par(xpd=TRUE)
points(dapc.obj$grp.coord[,1],dapc.obj$grp.coord[,2],pch=c(22,21,24),cex=2,lwd=3,col=&quot;black&quot;,bg=cols)
</code></pre>

<pre><code class="language-r">temp.dapc.obj &lt;- dapc(m0.1_lchp_n.s,center=T,scale=F,n.pca=500,n.da=2)
temp &lt;- optim.a.score(temp.dapc.obj)
best.n.pca &lt;- temp$best
dapc.obj &lt;- dapc(m0.1_lchp_n.s,center=T,scale=F,n.pca=best.n.pca,n.da=2)

scatter(dapc.obj,col=cols,ratio.pca=0.3,bg=&quot;white&quot;,main=&quot;m = 0.1, low complexity, high permeability, neutral and selected loci&quot;,
    pch=15:17,cell=0,cstar=0,solid=0.9,cex=1.8,clab=0,
    mstree=TRUE,lwd=3,scree.da=FALSE,leg=TRUE,txt.leg=popNames(m0.1_lchp_n))
par(xpd=TRUE)
points(dapc.obj$grp.coord[,1],dapc.obj$grp.coord[,2],pch=c(22,21,24),cex=2,lwd=3,col=&quot;black&quot;,bg=cols)
</code></pre>

<pre><code class="language-r">temp.dapc.obj &lt;- dapc(m0.5_lchp_n,center=T,scale=F,n.pca=500,n.da=2)
temp &lt;- optim.a.score(temp.dapc.obj)
best.n.pca &lt;- temp$best
dapc.obj &lt;- dapc(m0.5_lchp_n,center=T,scale=F,n.pca=best.n.pca,n.da=2)

scatter(dapc.obj,col=cols,ratio.pca=0.3,bg=&quot;white&quot;,main=&quot;m = 0.5, low complexity, high permeability, neutral loci only&quot;,
    pch=15:17,cell=0,cstar=0,solid=0.9,cex=1.8,clab=0,
    mstree=TRUE,lwd=3,scree.da=FALSE,leg=TRUE,txt.leg=popNames(m0.5_lchp_n))
par(xpd=TRUE)
points(dapc.obj$grp.coord[,1],dapc.obj$grp.coord[,2],pch=c(22,21,24),cex=2,lwd=3,col=&quot;black&quot;,bg=cols)
</code></pre>

<pre><code class="language-r">temp.dapc.obj &lt;- dapc(m0.5_lchp_s,center=T,scale=F,n.pca=500,n.da=2)
temp &lt;- optim.a.score(temp.dapc.obj)
best.n.pca &lt;- temp$best
dapc.obj &lt;- dapc(m0.5_lchp_s,center=T,scale=F,n.pca=best.n.pca,n.da=2)

scatter(dapc.obj,col=cols,ratio.pca=0.3,bg=&quot;white&quot;,main=&quot;m = 0.5, low complexity, high permeability, selected loci only&quot;,
    pch=15:17,cell=0,cstar=0,solid=0.9,cex=1.8,clab=0,
    mstree=TRUE,lwd=3,scree.da=FALSE,leg=TRUE,txt.leg=popNames(m0.5_lchp_n))
par(xpd=TRUE)
points(dapc.obj$grp.coord[,1],dapc.obj$grp.coord[,2],pch=c(22,21,24),cex=2,lwd=3,col=&quot;black&quot;,bg=cols)
</code></pre>

<pre><code class="language-r">temp.dapc.obj &lt;- dapc(m0.5_lchp_n.s,center=T,scale=F,n.pca=500,n.da=2)
temp &lt;- optim.a.score(temp.dapc.obj)
best.n.pca &lt;- temp$best
dapc.obj &lt;- dapc(m0.5_lchp_n.s,center=T,scale=F,n.pca=best.n.pca,n.da=2)

scatter(dapc.obj,col=cols,ratio.pca=0.3,bg=&quot;white&quot;,main=&quot;m = 0.5, low complexity, high permeability, neutral and selected loci&quot;,
    pch=15:17,cell=0,cstar=0,solid=0.9,cex=1.8,clab=0,
    mstree=TRUE,lwd=3,scree.da=FALSE,leg=TRUE,txt.leg=popNames(m0.5_lchp_n))
par(xpd=TRUE)
points(dapc.obj$grp.coord[,1],dapc.obj$grp.coord[,2],pch=c(22,21,24),cex=2,lwd=3,col=&quot;black&quot;,bg=cols)
</code></pre>

<pre><code class="language-r">temp.dapc.obj &lt;- dapc(m0.1_hclp_n,center=T,scale=F,n.pca=500,n.da=2)
temp &lt;- optim.a.score(temp.dapc.obj)
best.n.pca &lt;- temp$best
dapc.obj &lt;- dapc(m0.1_hclp_n,center=T,scale=F,n.pca=best.n.pca,n.da=2)

scatter(dapc.obj,col=cols,ratio.pca=0.3,bg=&quot;white&quot;,main=&quot;m = 0.1, high complexity, low permeability, neutral loci only&quot;,
    pch=15:17,cell=0,cstar=0,solid=0.9,cex=1.8,clab=0,
    mstree=TRUE,lwd=3,scree.da=FALSE,leg=TRUE,txt.leg=popNames(m0.1_hclp_n))
par(xpd=TRUE)
points(dapc.obj$grp.coord[,1],dapc.obj$grp.coord[,2],pch=c(22,21,24),cex=2,lwd=3,col=&quot;black&quot;,bg=cols)
</code></pre>

<pre><code class="language-r">temp.dapc.obj &lt;- dapc(m0.1_hclp_s,center=T,scale=F,n.pca=500,n.da=2)
temp &lt;- optim.a.score(temp.dapc.obj)
best.n.pca &lt;- temp$best
dapc.obj &lt;- dapc(m0.1_hclp_s,center=T,scale=F,n.pca=best.n.pca,n.da=2)

scatter(dapc.obj,col=cols,ratio.pca=0.3,bg=&quot;white&quot;,main=&quot;m = 0.1, high complexity, low permeability, selected loci only&quot;,
    pch=15:17,cell=0,cstar=0,solid=0.9,cex=1.8,clab=0,
    mstree=TRUE,lwd=3,scree.da=FALSE,leg=TRUE,txt.leg=popNames(m0.1_hclp_n))
par(xpd=TRUE)
points(dapc.obj$grp.coord[,1],dapc.obj$grp.coord[,2],pch=c(22,21,24),cex=2,lwd=3,col=&quot;black&quot;,bg=cols)
</code></pre>

<pre><code class="language-r">temp.dapc.obj &lt;- dapc(m0.1_hclp_n.s,center=T,scale=F,n.pca=500,n.da=2)
temp &lt;- optim.a.score(temp.dapc.obj)
best.n.pca &lt;- temp$best
dapc.obj &lt;- dapc(m0.1_hclp_n.s,center=T,scale=F,n.pca=best.n.pca,n.da=2)

scatter(dapc.obj,col=cols,ratio.pca=0.3,bg=&quot;white&quot;,main=&quot;m = 0.1, high complexity, low permeability, neutral and selected loci&quot;,
    pch=15:17,cell=0,cstar=0,solid=0.9,cex=1.8,clab=0,
    mstree=TRUE,lwd=3,scree.da=FALSE,leg=TRUE,txt.leg=popNames(m0.1_hclp_n))
par(xpd=TRUE)
points(dapc.obj$grp.coord[,1],dapc.obj$grp.coord[,2],pch=c(22,21,24),cex=2,lwd=3,col=&quot;black&quot;,bg=cols)
</code></pre>

<pre><code class="language-r">temp.dapc.obj &lt;- dapc(m0.5_hclp_n,center=T,scale=F,n.pca=500,n.da=2)
temp &lt;- optim.a.score(temp.dapc.obj)
best.n.pca &lt;- temp$best
dapc.obj &lt;- dapc(m0.5_hclp_n,center=T,scale=F,n.pca=best.n.pca,n.da=2)

scatter(dapc.obj,col=cols,ratio.pca=0.3,bg=&quot;white&quot;,main=&quot;m = 0.5, high complexity, low permeability, neutral loci only&quot;,
    pch=15:17,cell=0,cstar=0,solid=0.9,cex=1.8,clab=0,
    mstree=TRUE,lwd=3,scree.da=FALSE,leg=TRUE,txt.leg=popNames(m0.5_hclp_n))
par(xpd=TRUE)
points(dapc.obj$grp.coord[,1],dapc.obj$grp.coord[,2],pch=c(22,21,24),cex=2,lwd=3,col=&quot;black&quot;,bg=cols)
</code></pre>

<pre><code class="language-r">temp.dapc.obj &lt;- dapc(m0.5_hclp_s,center=T,scale=F,n.pca=500,n.da=2)
temp &lt;- optim.a.score(temp.dapc.obj)
best.n.pca &lt;- temp$best
dapc.obj &lt;- dapc(m0.5_hclp_s,center=T,scale=F,n.pca=best.n.pca,n.da=2)

scatter(dapc.obj,col=cols,ratio.pca=0.3,bg=&quot;white&quot;,main=&quot;m = 0.5, high complexity, low permeability, selected loci only&quot;,
    pch=15:17,cell=0,cstar=0,solid=0.9,cex=1.8,clab=0,
    mstree=TRUE,lwd=3,scree.da=FALSE,leg=TRUE,txt.leg=popNames(m0.5_hclp_n))
par(xpd=TRUE)
points(dapc.obj$grp.coord[,1],dapc.obj$grp.coord[,2],pch=c(22,21,24),cex=2,lwd=3,col=&quot;black&quot;,bg=cols)
</code></pre>

<pre><code class="language-r">temp.dapc.obj &lt;- dapc(m0.5_hclp_n.s,center=T,scale=F,n.pca=500,n.da=2)
temp &lt;- optim.a.score(temp.dapc.obj)
best.n.pca &lt;- temp$best
dapc.obj &lt;- dapc(m0.5_hclp_n.s,center=T,scale=F,n.pca=best.n.pca,n.da=2)

scatter(dapc.obj,col=cols,ratio.pca=0.3,bg=&quot;white&quot;,main=&quot;m = 0.5, high complexity, low permeability, neutral and selected loci&quot;,
    pch=15:17,cell=0,cstar=0,solid=0.9,cex=1.8,clab=0,
    mstree=TRUE,lwd=3,scree.da=FALSE,leg=TRUE,txt.leg=popNames(m0.5_hclp_n))
par(xpd=TRUE)
points(dapc.obj$grp.coord[,1],dapc.obj$grp.coord[,2],pch=c(22,21,24),cex=2,lwd=3,col=&quot;black&quot;,bg=cols)
</code></pre>

<pre><code class="language-r">temp.dapc.obj &lt;- dapc(m0.1_hchp_n,center=T,scale=F,n.pca=500,n.da=2)
temp &lt;- optim.a.score(temp.dapc.obj)
best.n.pca &lt;- temp$best
dapc.obj &lt;- dapc(m0.1_hchp_n,center=T,scale=F,n.pca=best.n.pca,n.da=2)

scatter(dapc.obj,col=cols,ratio.pca=0.3,bg=&quot;white&quot;,main=&quot;m = 0.1, high complexity, high permeability, neutral loci only&quot;,
    pch=15:17,cell=0,cstar=0,solid=0.9,cex=1.8,clab=0,
    mstree=TRUE,lwd=3,scree.da=FALSE,leg=TRUE,txt.leg=popNames(m0.1_hchp_n))
par(xpd=TRUE)
points(dapc.obj$grp.coord[,1],dapc.obj$grp.coord[,2],pch=c(22,21,24),cex=2,lwd=3,col=&quot;black&quot;,bg=cols)
</code></pre>

<pre><code class="language-r">temp.dapc.obj &lt;- dapc(m0.1_hchp_s,center=T,scale=F,n.pca=500,n.da=2)
temp &lt;- optim.a.score(temp.dapc.obj)
best.n.pca &lt;- temp$best
dapc.obj &lt;- dapc(m0.1_hchp_s,center=T,scale=F,n.pca=best.n.pca,n.da=2)

scatter(dapc.obj,col=cols,ratio.pca=0.3,bg=&quot;white&quot;,main=&quot;m = 0.1, high complexity, high permeability, selected loci only&quot;,
    pch=15:17,cell=0,cstar=0,solid=0.9,cex=1.8,clab=0,
    mstree=TRUE,lwd=3,scree.da=FALSE,leg=TRUE,txt.leg=popNames(m0.1_hchp_n))
par(xpd=TRUE)
points(dapc.obj$grp.coord[,1],dapc.obj$grp.coord[,2],pch=c(22,21,24),cex=2,lwd=3,col=&quot;black&quot;,bg=cols)
</code></pre>

<pre><code class="language-r">temp.dapc.obj &lt;- dapc(m0.1_hchp_n.s,center=T,scale=F,n.pca=500,n.da=2)
temp &lt;- optim.a.score(temp.dapc.obj)
best.n.pca &lt;- temp$best
dapc.obj &lt;- dapc(m0.1_hchp_n.s,center=T,scale=F,n.pca=best.n.pca,n.da=2)

scatter(dapc.obj,col=cols,ratio.pca=0.3,bg=&quot;white&quot;,main=&quot;m = 0.1, high complexity, high permeability, neutral and selected loci&quot;,
    pch=15:17,cell=0,cstar=0,solid=0.9,cex=1.8,clab=0,
    mstree=TRUE,lwd=3,scree.da=FALSE,leg=TRUE,txt.leg=popNames(m0.1_hchp_n))
par(xpd=TRUE)
points(dapc.obj$grp.coord[,1],dapc.obj$grp.coord[,2],pch=c(22,21,24),cex=2,lwd=3,col=&quot;black&quot;,bg=cols)
</code></pre>

<pre><code class="language-r">temp.dapc.obj &lt;- dapc(m0.5_hchp_n,center=T,scale=F,n.pca=500,n.da=2)
temp &lt;- optim.a.score(temp.dapc.obj)
best.n.pca &lt;- temp$best
dapc.obj &lt;- dapc(m0.5_hchp_n,center=T,scale=F,n.pca=best.n.pca,n.da=2)

scatter(dapc.obj,col=cols,ratio.pca=0.3,bg=&quot;white&quot;,main=&quot;m = 0.5, high complexity, high permeability, neutral loci only&quot;,
    pch=15:17,cell=0,cstar=0,solid=0.9,cex=1.8,clab=0,
    mstree=TRUE,lwd=3,scree.da=FALSE,leg=TRUE,txt.leg=popNames(m0.5_hchp_n))
par(xpd=TRUE)
points(dapc.obj$grp.coord[,1],dapc.obj$grp.coord[,2],pch=c(22,21,24),cex=2,lwd=3,col=&quot;black&quot;,bg=cols)
</code></pre>

<pre><code class="language-r">temp.dapc.obj &lt;- dapc(m0.5_hchp_s,center=T,scale=F,n.pca=500,n.da=2)
temp &lt;- optim.a.score(temp.dapc.obj)
best.n.pca &lt;- temp$best
dapc.obj &lt;- dapc(m0.5_hchp_s,center=T,scale=F,n.pca=best.n.pca,n.da=2)

scatter(dapc.obj,col=cols,ratio.pca=0.3,bg=&quot;white&quot;,main=&quot;m = 0.5, high complexity, high permeability, selected loci only&quot;,
    pch=15:17,cell=0,cstar=0,solid=0.9,cex=1.8,clab=0,
    mstree=TRUE,lwd=3,scree.da=FALSE,leg=TRUE,txt.leg=popNames(m0.5_hchp_n))
par(xpd=TRUE)
points(dapc.obj$grp.coord[,1],dapc.obj$grp.coord[,2],pch=c(22,21,24),cex=2,lwd=3,col=&quot;black&quot;,bg=cols)
</code></pre>

<pre><code class="language-r">temp.dapc.obj &lt;- dapc(m0.5_hchp_n.s,center=T,scale=F,n.pca=500,n.da=2)
temp &lt;- optim.a.score(temp.dapc.obj)
best.n.pca &lt;- temp$best
dapc.obj &lt;- dapc(m0.5_hchp_n.s,center=T,scale=F,n.pca=best.n.pca,n.da=2)

scatter(dapc.obj,col=cols,ratio.pca=0.3,bg=&quot;white&quot;,main=&quot;m = 0.5, high complexity, high permeability, neutral and selected loci&quot;,
    pch=15:17,cell=0,cstar=0,solid=0.9,cex=1.8,clab=0,
    mstree=TRUE,lwd=3,scree.da=FALSE,leg=TRUE,txt.leg=popNames(m0.5_hchp_n))
par(xpd=TRUE)
points(dapc.obj$grp.coord[,1],dapc.obj$grp.coord[,2],pch=c(22,21,24),cex=2,lwd=3,col=&quot;black&quot;,bg=cols)
</code></pre>

<pre><code class="language-r">#plot parameters
par(mfrow=c(1,1),fg=&quot;gray50&quot;,pty='m',bty='o',mar=c(4,4,4,4),cex.main=1.3,cex.axis=1.1,cex.lab=1.2)

##Gen and Env data frames
##make this iterative for all simulated datasets: currently only one of them shown here
gen &lt;- m0.1_lchp_n.s
dfenv &lt;- extract(fa_stk,gen$other)
dfenv.obj &lt;- dfenv
dfgen.obj &lt;- gen$tab
dfgenenv &lt;- cbind(gen$tab,dfenv)
dfgenenv &lt;- na.omit(dfgenenv)
dfgen &lt;- dfgenenv[,1:180]
dfenv &lt;- dfgenenv[,181:185]

###Co-inertia###by individual###

pcenv &lt;- dudi.pca(dfenv, cent=T,scale=T,scannf=F,nf=2)
pcgen &lt;- dudi.pca(dfgen, cent=T, scale=F, scannf=F, nf=2)
coi &lt;- coinertia(pcenv,pcgen,scan=F,nf=2)
#plot(coi)
summary(coi)
#rvind=RV.rtest(pcenv$l1,pcgen$l1,nrepet=9999)$obs
#rvindpval=RV.rtest(pcenv$l1,pcgen$l1,nrepet=9999)$pvalue
rvind=RV.rtest(coi$lX,coi$lY,nrepet=9999)$obs
rvindpval=RV.rtest(coi$lX,coi$lY,nrepet=9999)$pvalue


###Co-inertia###by site/pop###

dap20 &lt;- dapc.obj$grp
dfdap20 &lt;- cbind(dap20,dfenv.obj)
dfdap20 &lt;- na.omit(dfdap20)
dfdap20 &lt;- dfdap20[,1]
dfdap20 &lt;- as.factor(as.numeric(dfdap20))

pcenv &lt;- dudi.pca(dfenv, cent=T, scale=T, scannf=F, nf=2)
bet1 &lt;- bca(pcenv, dfdap20, scannf=F, nf=2)
pcgen &lt;- dudi.pca(dfgen, cent=T, scale=F, scannf=F, nf=2)
bet2 &lt;- bca(pcgen, dfdap20, scannf=F, nf=2)
coi20 &lt;- coinertia(bet1,bet2,scan=F,nf=2)
plot(coi20)
summary(coi20)
rv20 &lt;- RV.rtest(coi20$lX,coi20$lY,nrepet=9999)$obs
rv20pval &lt;- RV.rtest(coi20$lX,coi20$lY,nrepet=9999)$pvalue


###Co-inertia###by cluster###

##Clusters##
clust &lt;- find.clusters(gen,cent=T,scale=F,n.pca=best.n.pca,method=&quot;kmeans&quot;,n.iter=1e7,n.clust=10,stat=&quot;BIC&quot;)
cl &lt;- as.factor(as.vector(clust$grp))
gen$pop &lt;- cl
sq &lt;- as.character(seq(1,10))
popNames(gen) &lt;- sq
dapc10 &lt;- dapc(gen,center=T,scale=F,n.pca=best.n.pca,n.da=2)
scatter(dapc10,col=cols,ratio.pca=0.3,bg=&quot;white&quot;,pch=15:17,cell=0,cstar=0,solid=0.9,cex=1.8,clab=0,mstree=TRUE,lwd=3,scree.da=FALSE,leg=TRUE,txt.leg=popNames(gen))
par(xpd=TRUE)
points(dapc10$grp.coord[,1],dapc10$grp.coord[,2],pch=c(22,21,24),cex=2,lwd=3,col=&quot;black&quot;,bg=cols)

dap10 &lt;- as.data.frame(dapc10$assign)

dfdap10 &lt;- cbind(dap10,dfenv.obj)
dfdap10 &lt;- na.omit(dfdap10)
dfenv10 &lt;- dfdap10[,2:length(dfdap10[1,])]
dfdap10 &lt;- dfdap10[,1]

dfgenenv10 &lt;- cbind(dap10,gen$tab,dfenv.obj)
dfgenenv10 &lt;- na.omit(dfgenenv10)
dfdap10 &lt;- dfgenenv10[,1]
dfgenenv10.gen &lt;- dfgenenv10[,2:181]
dfgenenv10.env &lt;- dfgenenv10[,182:186]


pcenv10 &lt;- dudi.pca(dfenv10, cent=T, scale=T, scannf=F, nf=2)
bet1 &lt;- bca(pcenv10, dfdap10, scannf=F, nf=2)
pcgen10 &lt;- dudi.pca(dfgen, cent=T, scale=F, scannf=F, nf=2)
bet2 &lt;- bca(pcgen10, dfdap10, scannf=F, nf=2)
coi10 &lt;- coinertia(bet1,bet2,scan=F,nf=2)
plot(coi10)
summary(coi10)
s.class(pcgen10$l1,dfdap10)
s.class(pcenv10$l1,dfdap10)

rv10=RV.rtest(coi10$lX,coi10$lY,nrepet=9999)$obs
rv10pval=RV.rtest(coi10$lX,coi10$lY,nrepet=9999)$pvalue
</code></pre>

<h2 id="comparison-to-dapc-inferring-population-structure-with-lea-package">Comparison to DAPC: Inferring population structure with <em>LEA</em> package</h2>

<pre><code class="language-r">library(LEA)
library(mapplots)
library(maps)
library(raster)
library(adegenet)

#plot parameters
par(mfrow=c(1,1),fg=&quot;gray50&quot;,pty='m',bty='o',mar=c(4,4,4,4),cex.main=1.3,cex.axis=1.1,cex.lab=1.2)

simsubset.dir &lt;- c(
        &quot;C:/Users/chazh/Documents/Research Projects/Reticulitermes/Simulations/popRange/m_0_1/Simulated_Genotypes/20pop_subsets/neutral+selected/&quot;,
        &quot;C:/Users/chazh/Documents/Research Projects/Reticulitermes/Simulations/popRange/m_0_5/Simulated_Genotypes/20pop_subsets/neutral+selected/&quot;
        )

sims &lt;- c(&quot;lclp&quot;, &quot;lchp&quot;, &quot;hclp&quot;, &quot;hchp&quot;)

ls_names &lt;- c(&quot;LCLP landscape&quot;, &quot;LCHP landscape&quot;, &quot;HCLP landscape&quot;, &quot;HCHP landscape&quot;)

lea.dir &lt;- c(
       &quot;C:/Users/chazh/Documents/Research Projects/Reticulitermes/Simulations/popRange/m_0_1/Simulated_Landscapes/500neutral+50selectedSNPs/Low_Complexity_Landscapes/landscapeR/Low_Permeability/&quot;,
       &quot;C:/Users/chazh/Documents/Research Projects/Reticulitermes/Simulations/popRange/m_0_1/Simulated_Landscapes/500neutral+50selectedSNPs/Low_Complexity_Landscapes/landscapeR/High_Permeability/&quot;,
       &quot;C:/Users/chazh/Documents/Research Projects/Reticulitermes/Simulations/popRange/m_0_1/Simulated_Landscapes/500neutral+50selectedSNPs/High_Complexity_Landscapes/virtualspecies/Low_Permeability/&quot;,
           &quot;C:/Users/chazh/Documents/Research Projects/Reticulitermes/Simulations/popRange/m_0_1/Simulated_Landscapes/500neutral+50selectedSNPs/High_Complexity_Landscapes/virtualspecies/High_Permeability/&quot;,
       &quot;C:/Users/chazh/Documents/Research Projects/Reticulitermes/Simulations/popRange/m_0_5/Simulated_Landscapes/500neutral+50selectedSNPs/Low_Complexity_Landscapes/landscapeR/Low_Permeability/&quot;,
       &quot;C:/Users/chazh/Documents/Research Projects/Reticulitermes/Simulations/popRange/m_0_5/Simulated_Landscapes/500neutral+50selectedSNPs/Low_Complexity_Landscapes/landscapeR/High_Permeability/&quot;,
       &quot;C:/Users/chazh/Documents/Research Projects/Reticulitermes/Simulations/popRange/m_0_5/Simulated_Landscapes/500neutral+50selectedSNPs/High_Complexity_Landscapes/virtualspecies/Low_Permeability/&quot;,
       &quot;C:/Users/chazh/Documents/Research Projects/Reticulitermes/Simulations/popRange/m_0_5/Simulated_Landscapes/500neutral+50selectedSNPs/High_Complexity_Landscapes/virtualspecies/High_Permeability/&quot;
           )
for (j in 1:2){
   for (i in 1:4){
      genind.obj &lt;- read.genepop(paste0(simsubset.dir[j], sims[i], &quot;_20pops.gen&quot;))
      genind.obj$other &lt;- read.table(paste0(simsubset.dir[j], sims[i], &quot;_20pops_coords.txt&quot;), sep=&quot; &quot;,header=F)
      colnames(genind.obj$other)=c(&quot;x&quot;,&quot;y&quot;)
      genind.obj$other &lt;- xyFromRC(genind.obj, fa_stk)
      genotypes &lt;- genind.obj@tab
      coordinates &lt;- genind.obj$other
      
      ji &lt;- (j - 1) * 4 + i           
      setwd(lea.dir[ji])
      write.table(t(as.matrix(genotypes)), sep=&quot;&quot;, row.names=F, col.names=F, paste0(sims[i], &quot;.geno&quot;))
      geno &lt;- read.geno(paste0(sims[i],&quot;.geno&quot;))
      coord &lt;- coordinates
      setwd(paste0(lea.dir[ji],&quot;LEA&quot;))
      source(&quot;POPSutilities.r&quot;)
      setwd(lea.dir[ji])

      reps &lt;- 5
      maxK &lt;- 10

      #running pop structure inference
      snmf.obj &lt;- snmf(paste0(sims[i],&quot;.geno&quot;), K=1:maxK, repetitions=reps, project=&quot;new&quot;, 
              alpha=10, iterations=100000,
                  entropy=TRUE,percentage=0.25)
      plot(snmf.obj,cex=1.2,col=&quot;lightblue&quot;,pch=19)

      #determining best K and picking best replicate for best K
      ce &lt;- list()
      for(i in 1:maxK) ce[[i]] &lt;- cross.entropy(snmf.obj, K=i)
      best &lt;- which.min(unlist(ce))
      best.K &lt;- ceiling(best/reps)
      best.run &lt;- which.min(ce[[best.K]])
      
      my.colors &lt;- futr(best.K)
      
      barchart(snmf.obj, K=best.K, run=best.run,
           border=NA, space=0, col=my.colors,
           xlab=&quot;Individuals&quot;, ylab=&quot;Ancestry proportions&quot;,
           main=paste(&quot;Ancestry bar chart for&quot;, ls_names[i]))
      
      qmatrix &lt;- Q(snmf.obj,K=best.K,run=best.run)
      
      grid &lt;- createGrid(min(coord[,1]),max(coord[,1]),
                min(coord[,2]),max(coord[,2]),500,500)
      constraints &lt;- NULL
      
      futr.gradient=colorRampPalette(futr(best.K))
      grad.cols=futr.gradient(best.K*10)
      
      ColorGradients_bestK &lt;- list()
    for(i in 1:best.K){ 
      k.start &lt;- i*10-9
      k.fin &lt;- i*10
      ColorGradients_bestK[[i]] &lt;- c(&quot;gray95&quot;, grad.cols[k.start:k.fin])
    }

       maps(matrix=qmatrix, cbind(coord[,1],coord[,2]), grid, constraints, method=&quot;max&quot;,
         colorGradientsList=ColorGradients_bestK,
         main=paste(&quot;Mapped ancestry coefficients for&quot;, ls_names[i]), 
         xlab=&quot;Longitude&quot;, ylab=&quot;Latitude&quot;, cex=.5)
       map(add=T,interior=F)
   }
}
</code></pre>

<h2 id="comparison-to-dapc-inferring-population-structure-with-tess3r-package">Comparison to DAPC: Inferring population structure with <em>tess3r</em> package</h2>

<pre><code class="language-r">library(tess3r)
library(adegenet)

#plot parameters
par(mfrow=c(1,1),fg=&quot;gray50&quot;,pty='m',bty='o',mar=c(4,4,4,4),cex.main=1.3,cex.axis=1.1,cex.lab=1.2)

simsubset.dir &lt;- c(
        &quot;C:/Users/chazh/Documents/Research Projects/Reticulitermes/Simulations/popRange/m_0_1/Simulated_Genotypes/20pop_subsets/neutral+selected/&quot;,
        &quot;C:/Users/chazh/Documents/Research Projects/Reticulitermes/Simulations/popRange/m_0_5/Simulated_Genotypes/20pop_subsets/neutral+selected/&quot;
        )

sims &lt;- c(&quot;lclp&quot;, &quot;lchp&quot;, &quot;hclp&quot;, &quot;hchp&quot;)

ls_names &lt;- c(&quot;LCLP landscape&quot;, &quot;LCHP landscape&quot;, &quot;HCLP landscape&quot;, &quot;HCHP landscape&quot;)

lea.dir &lt;- c(
       &quot;C:/Users/chazh/Documents/Research Projects/Reticulitermes/Simulations/popRange/m_0_1/Simulated_Landscapes/500neutral+50selectedSNPs/Low_Complexity_Landscapes/landscapeR/Low_Permeability/&quot;,
       &quot;C:/Users/chazh/Documents/Research Projects/Reticulitermes/Simulations/popRange/m_0_1/Simulated_Landscapes/500neutral+50selectedSNPs/Low_Complexity_Landscapes/landscapeR/High_Permeability/&quot;,
       &quot;C:/Users/chazh/Documents/Research Projects/Reticulitermes/Simulations/popRange/m_0_1/Simulated_Landscapes/500neutral+50selectedSNPs/High_Complexity_Landscapes/virtualspecies/Low_Permeability/&quot;,
           &quot;C:/Users/chazh/Documents/Research Projects/Reticulitermes/Simulations/popRange/m_0_1/Simulated_Landscapes/500neutral+50selectedSNPs/High_Complexity_Landscapes/virtualspecies/High_Permeability/&quot;,
       &quot;C:/Users/chazh/Documents/Research Projects/Reticulitermes/Simulations/popRange/m_0_5/Simulated_Landscapes/500neutral+50selectedSNPs/Low_Complexity_Landscapes/landscapeR/Low_Permeability/&quot;,
       &quot;C:/Users/chazh/Documents/Research Projects/Reticulitermes/Simulations/popRange/m_0_5/Simulated_Landscapes/500neutral+50selectedSNPs/Low_Complexity_Landscapes/landscapeR/High_Permeability/&quot;,
       &quot;C:/Users/chazh/Documents/Research Projects/Reticulitermes/Simulations/popRange/m_0_5/Simulated_Landscapes/500neutral+50selectedSNPs/High_Complexity_Landscapes/virtualspecies/Low_Permeability/&quot;,
       &quot;C:/Users/chazh/Documents/Research Projects/Reticulitermes/Simulations/popRange/m_0_5/Simulated_Landscapes/500neutral+50selectedSNPs/High_Complexity_Landscapes/virtualspecies/High_Permeability/&quot;
           )
           
for (j in 1:2){
   for (i in 1:4){
      genind.obj &lt;- read.genepop(paste0(simsubset.dir[j], sims[i], &quot;_20pops.gen&quot;))
      genind.obj$other &lt;- read.table(paste0(simsubset.dir[j], sims[i], &quot;_20pops_coords.txt&quot;), sep=&quot; &quot;,header=F)
      colnames(genind.obj$other)=c(&quot;x&quot;,&quot;y&quot;)
      genind.obj$other &lt;- xyFromRC(genind.obj, fa_stk)
      genotypes &lt;- genind.obj@tab
      coords &lt;- genind.obj$other
      
      ji &lt;- (j - 1) * 4 + i           
      setwd(lea.dir[ji])
      write.table(t(as.matrix(genotypes)), sep=&quot;&quot;, row.names=F, col.names=F, paste0(sims[i], &quot;.geno&quot;))
      geno &lt;- read.geno(paste0(sims[i],&quot;.geno&quot;))
      setwd(paste0(lea.dir[ji],&quot;LEA&quot;))
      source(&quot;POPSutilities.r&quot;)
      setwd(lea.dir[ji])

      reps &lt;- 5
      maxK &lt;- 10

      #running pop structure inference
      tess3.obj &lt;- tess3(X=genotypes, coord=coordinates, K=1:maxK,
                         method=&quot;projected.ls&quot;, rep=reps, 
                         max.iteration=1000, tolerance=1e-06, 
                         #max.iteration = 10000, tolerance = 1e-07, 
                         mask=0.25,
                         ploidy=2)

      #determining best K and picking best replicate for best K
      ce &lt;- list()
      for(i in 1:maxK) ce[[i]] &lt;- tess3.obj[[i]]$crossvalid.crossentropy
      best &lt;- which.min(unlist(ce))
      best.K &lt;- ceiling(best/reps)
      best.run &lt;- which.min(ce[[best.K]])

      q.matrix &lt;- qmatrix(tess3.obj, K=best.K)

      futr.pal &lt;- CreatePalette(futr(best.K),10)

      barplot(q.matrix, border = NA, space = 0,
          col.palette = futr.pal,
          xlab = &quot;Individuals&quot;, ylab = &quot;Ancestry proportions&quot;,
          main = paste(&quot;Ancestry bar chart for&quot;, ls_names[i]))
  
      plot(q.matrix, coordinates, method = &quot;map.max&quot;, interpol = FieldsKrigModel(10),
       main = paste(&quot;Mapped ancestry coefficients for&quot;, ls_names[i]),
       xlab = &quot;Longitude&quot;, ylab = &quot;Latitude&quot;,
       resolution = c(500,500), cex = .8,
       col.palette = futr.pal)
   }
}
</code></pre>
		</div>
		
<div class="post__tags tags clearfix">
	<svg class="tags__icon icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item"><a class="tags__link btn" href="/NALgen/tags/multivariate-ordination/" rel="tag">Multivariate Ordination</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/NALgen/tags/discriminant-analysis-of-principal-components/" rel="tag">Discriminant Analysis of Principal Components</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/NALgen/tags/co-inertia-analysis/" rel="tag">Co-inertia Analysis</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/NALgen/tags/population-structure/" rel="tag">Population Structure</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/NALgen/tags/genetic-environmental-covariance/" rel="tag">Genetic-Environmental Covariance</a></li>
	</ul>
</div>
	</article>
</main>

<div class="authorbox clearfix">
	<figure class="authorbox__avatar">
		<img alt="Chaz Hyseni avatar" src="/NALgen/img/SpEcEvGen.png" class="avatar" height="90" width="90">
	</figure>
	<div class="authorbox__header">
		<span class="authorbox__name">About Chaz Hyseni</span>
	</div>
	<div class="authorbox__description">
		Chaz has been doing research in the field of Population Genetics since 2006. He is interested in the distribution of genetic variation (both neutral and adaptive) in natural environments, at different spatial and temporal scales (from Landscape Genetics to Phylogeography). To understand pattern and process, Chaz uses empirical data as well as spatial eco-evolutionary modeling.
	</div>
</div>

<nav class="post-nav flex">
	<div class="post-nav__item post-nav__item--prev">
		<a class="post-nav__link" href="/NALgen/post/landscape-genetic-simulations/" rel="prev"><span class="post-nav__caption">Â«&thinsp;Previous</span><p class="post-nav__post-title">Landscape Genetic Simulations</p></a>
	</div>
</nav>


			</div>
			<aside class="sidebar">
<div class="widget-recent widget">
	<h4 class="widget__title">Recent Posts</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/NALgen/post/multivariateanalysis_popstruct_simulateddata/">NALgen Analysis Pt.1</a></li>
			<li class="widget__item"><a class="widget__link" href="/NALgen/post/landscape-genetic-simulations/">Landscape Genetic Simulations</a></li>
		</ul>
	</div>
</div>
<div class="widget-categories widget">
	<h4 class="widget__title">Categories</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/NALgen/categories/analysis">Analysis</a></li>
			<li class="widget__item"><a class="widget__link" href="/NALgen/categories/simulations">Simulations</a></li>
		</ul>
	</div>
</div>
<div class="widget-taglist widget">
	<h4 class="widget__title">Tags</h4>
	<div class="widget__content">
		<a class="widget-taglist__link widget__link btn" href="/NALgen/tags/co-inertia-analysis" title="Co inertia analysis">Co inertia analysis</a>
		<a class="widget-taglist__link widget__link btn" href="/NALgen/tags/discriminant-analysis-of-principal-components" title="Discriminant analysis of principal components">Discriminant analysis of principal components</a>
		<a class="widget-taglist__link widget__link btn" href="/NALgen/tags/genetic-environmental-covariance" title="Genetic environmental covariance">Genetic environmental covariance</a>
		<a class="widget-taglist__link widget__link btn" href="/NALgen/tags/genotype-simulations" title="Genotype simulations">Genotype simulations</a>
		<a class="widget-taglist__link widget__link btn" href="/NALgen/tags/landscape-genetics" title="Landscape genetics">Landscape genetics</a>
		<a class="widget-taglist__link widget__link btn" href="/NALgen/tags/landscape-simulations" title="Landscape simulations">Landscape simulations</a>
		<a class="widget-taglist__link widget__link btn" href="/NALgen/tags/multivariate-ordination" title="Multivariate ordination">Multivariate ordination</a>
		<a class="widget-taglist__link widget__link btn" href="/NALgen/tags/population-structure" title="Population structure">Population structure</a>
	</div>
</div>
</aside>
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2019 NALgen.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/NALgen/js/menu.js"></script></body>
</html>